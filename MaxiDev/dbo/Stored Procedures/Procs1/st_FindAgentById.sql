CREATE PROCEDURE [dbo].[st_FindAgentById]
(
	@IdAgent		INT
)
AS
BEGIN
	SELECT
		a.IdAgent,
		a.IdAgentCommunication,
		a.IdAgentType,
		a.IdUserSeller,
		a.IdUserOpeningSalesRep,
		a.IdAgentStatus,
		a.IdAgentPaymentSchema,
		a.IdAgentReceiptType,
		a.IdAgentBankDeposit,
		a.AgentName,
		a.AgentCode,
		a.AgentAddress,
		a.AgentCity,
		a.AgentState,
		a.AgentZipcode,
		a.AgentPhone,
		a.AgentFax,
		a.AgentEmail,
		a.AgentContact,
		a.AgentTimeInBusiness,
		a.AgentBusinessType,
		a.GuarantorName,
		a.GuarantorLastName,
		a.GuarantorSecondLastName,
		a.GuarantorAddress,
		a.GuarantorCity,
		a.GuarantorState,
		a.GuarantorZipcode,
		a.GuarantorPhone,
		a.GuarantorCel,
		a.GuarantorEmail,
		a.GuarantorSSN,
		a.GuarantorIdType,
		a.GuarantorIdNumber,
		a.GuarantorIdExpirationDate,
		a.GuarantorBornDate,
		a.TaxID,
		a.CreditAmount,
		a.AmountRequiredToAskId,
		a.CreationDate,
		a.OpenDate,
		a.Notes,
		a.CloseDate,
		a.BusinessPermissionNumber,
		a.BusinessPermissionExpiration,
		a.DoneOnSundayPayOn,
		a.DoneOnMondayPayOn,
		a.DoneOnTuesdayPayOn,
		a.DoneOnWednesdayPayOn,
		a.DoneOnThursdayPayOn,
		a.DoneOnFridayPayOn,
		a.DoneOnSaturdayPayOn,
		a.DateOfLastChange,
		a.EnterByIdUser,
		a.SwitchCommission,
		a.SwitchExrate,
		a.CommissionTop,
		a.CommissionBottom,
		a.ExrateTop,
		a.ExrateBottom,
		a.ACHWellsFargo,
		a.ShowAgentProfitWhenSendingTransfer,
		a.GuarantorBornCountry,
		a.ExcludeReportSignatureHold,
		a.ExcludeReportExRates,
		a.ShowLogo,
		a.CancelReturnCommission,
		a.IdAgentClass,
		a.IdOwner,
		a.IdAgentCollectType,
		a.AccountNumber,
		a.RoutingNumber,
		a.RetainMoneyCommission,
		a.DoingBusinessAs,
		a.IdAgentCommissionPay,
		a.SubAccount,
		a.AccountNumberCommission,
		a.RoutingNumberCommission,
		a.UsePin,
		a.UsePayNow,
		a.IdCounty,
		a.IdCountyGuarantor,
		a.SuspendedDatePendingFile,
		a.BlockPhoneTransactions,
		a.MoneyAlertInvitation,
		a.CheckEditMicr,
		a.NoteCreditAmountChange,
		a.IdTimeZone,
		a.OfacBusinessChecked,
		a.OfacGuarantorChecked,
		a.OfacOwnerChecked,
		a.NeedsWFSubaccount,
		a.NeedsWFSubaccountDate,
		a.NeedsWFSubaccountIduser,
		a.RequestWFSubaccount,
		a.RequestWFSubaccountDate,
		a.RequestWFSubaccountIdUser,
		a.IdAgentsReportWellsFargo,
		a.StateCode,
		a.IdLogAccVerif,
		a.IdAgentGroup,
		a.IsSwitchSpecExRateGroup,
		a.ExpirationDateExRateGroup,
		a.ApplyKYCRules,
		a.IdAgentEntityType,
		a.IdAgentTaxIdType,
		a.AgentBusinessEmail,
		a.AgentBusinessWebsite,
		a.AgentFinCENReg,
		a.AgentFinCENRegExpiration,
		a.AgentCheckCasher,
		a.AgentCheckLicense,
		a.AgentCheckLicenseNumber,
		a.MailCheckTo,
		a.ComplianceOfficerDateOfBirth,
		a.ComplianceOfficerPlaceOfBirth,
		a.ComplianceOfficerName
	FROM Agent a WITH(NOLOCK)
	WHERE a.IdAgent = @IdAgent

	SELECT
		r.IdAgent,
		r.IdAgentCollectType,
		t.Name,
		r.IsDefault,
		r.CreationDate,
		r.EnterByIdUser
	FROM [Corp].[AgentCollectTypeRelAgent] r WITH(NOLOCK)
		JOIN AgentCollectType t WITH(NOLOCK) ON t.IdAgentCollectType = r.IdAgentCollectType
	WHERE r.IdAgent = @IdAgent
END
